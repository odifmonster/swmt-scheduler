from typing import Protocol, Literal
import datetime as dt
from app.support import HasID, SuperImmut, SuperView, Viewable
from app.style import GreigeStyle, Color, FabricStyle
from app.inventory import AllocRoll

class _Bucket(Protocol):
    item: FabricStyle
    @property
    def greige(self) -> GreigeStyle: ...
    @property
    def color(self) -> Color: ...
    @property
    def lots(self) -> list[DyeLotView]: ...
    @property
    def yds(self) -> float: ...
    @property
    def lbs(self) -> float: ...
    @property
    def date(self) -> dt.datetime: ...

class _ReqView(Protocol):
    item: FabricStyle
    @property
    def _prefix(self) -> str: ...
    @property
    def id(self) -> str: ...
    @property
    def greige(self) -> GreigeStyle: ...
    @property
    def color(self) -> Color: ...
    @property
    def lots(self) -> list[DyeLotView]: ...
    def __repr__(self) -> str: ...
    def __eq__(self, other: '_ReqView') -> bool: ...
    def __hash__(self) -> int: ...
    def bucket(self, pnum: Literal[1, 2, 3, 4]) -> _Bucket: ...
    def assign_lot(self, rolls: list[AllocRoll]) -> DyeLot: ...
    def unassign_lot(self, lot: DyeLotView) -> None: ...

class DyeLotView(SuperView['DyeLot']):
    start: dt.datetime
    end: dt.datetime
    rolls: tuple[AllocRoll, ...]
    item: FabricStyle
    @property
    def _prefix(self) -> str: ...
    @property
    def id(self) -> int: ...
    @property
    def greige(self) -> GreigeStyle: ...
    @property
    def color(self) -> Color: ...
    @property
    def lbs(self) -> float: ...
    @property
    def yds(self) -> float: ...
    @property
    def req(self) -> _ReqView: ...
    @property
    def due_date(self) -> dt.datetime: ...
    def __repr__(self) -> str: ...
    def __eq__(self, other: 'DyeLotView') -> bool: ...
    def __hash__(self) -> int: ...

class DyeLot(HasID[int], Viewable[DyeLotView], SuperImmut):
    start: dt.datetime
    end: dt.datetime
    rolls: tuple[AllocRoll, ...]
    item: FabricStyle
    def __init__(self, rolls: list[AllocRoll], item: FabricStyle, rview: _ReqView,
                 pnum: int) -> None: ...
    @property
    def _prefix(self) -> str: ...
    @property
    def id(self) -> int: ...
    @property
    def greige(self) -> GreigeStyle: ...
    @property
    def color(self) -> Color: ...
    @property
    def lbs(self) -> float: ...
    @property
    def yds(self) -> float: ...
    @property
    def req(self) -> _ReqView: ...
    @property
    def due_date(self) -> dt.datetime: ...